# 출근 후 일일결산 시스템 체크리스트

## 📋 실행 순서

내일 출근하셔서 아래 순서대로 진행하세요:

---

## 1️⃣ 사전 체크 스크립트 실행

```cmd
cd D:\결산
python pre_run_check.py
```

### 이 스크립트가 하는 일:

#### ✅ 1단계: 디렉토리 파일명 샘플 수집
- 각 장비 디렉토리의 실제 파일명 확인
- 오늘 날짜 파일 우선 샘플링 (🟢 표시)
- 결과를 `directory_samples.txt`에 저장

#### ✅ 2단계: 예약 엑셀 파일 읽기 테스트
- .xls/.xlsx 파일 지원 라이브러리 확인
- 예약 파일 찾기 및 읽기 테스트
- 샘플 데이터 표시

#### ✅ 3단계: 모든 경로 검증
- 장비 디렉토리 접근성 확인
- 오늘 날짜 폴더 존재 여부 확인
- 안저 경로 설정 상태 확인

---

## 2️⃣ 생성된 파일 확인

### 📄 `directory_samples.txt`
각 장비의 실제 파일명 샘플이 포함되어 있습니다.

**이 파일을 Claude에게 보내주세요!**
- 파일 내용을 복사해서 Claude에게 전달
- Claude가 올바른 정규식 패턴을 분석하여 제안
- 필요시 `config_real.json` 업데이트

### 📄 `pre_run_report_YYYYMMDD.txt`
상세한 체크 리포트:
- 각 단계별 성공/실패 상태
- 발견된 문제점
- 해결 방법 안내

---

## 3️⃣ 문제 해결

### 🔴 경로 접근 불가 오류
```
❌ 내피 (SP): 접근 불가 (\\192.168.0.120\sp)
```

**해결:**
1. 네트워크 연결 확인
2. Windows 탐색기에서 해당 경로 직접 접근 테스트
3. 경로가 다르면 `config_real.json` 수정

### 🟡 오늘 폴더 없음 경고
```
⚠️ Tomey (TOPO): 오늘 폴더 없음 (\\topo\Topo\2025\01\18)
```

**해결:**
1. 해당 장비로 검사가 진행되었는지 확인
2. 폴더 구조가 다르면 `config_real.json`의 `folder_structure` 수정

### 🔴 안저 경로 미설정
```
⚠️ 안저 경로 2: 미설정 (\\192.168.0.213\[TODO: ...])
```

**해결:**
```cmd
python find_fundus_path.py
```
→ 찾은 경로를 `config_real.json`에 업데이트

---

## 4️⃣ 패턴 분석 및 업데이트

### directory_samples.txt 예시:
```
장비: 내피 (SP)
================

파일명 샘플:
🟢 20250118_123456_100001.pdf (생성일: 2025-01-18)
🟢 20250118_134521_100234.pdf (생성일: 2025-01-18)
⚪ 20250117_091234_099876.pdf (생성일: 2025-01-17)
```

### Claude에게 요청:
```
directory_samples.txt 파일을 확인하고,
각 장비별로 올바른 정규식 패턴을 분석해주세요.

현재 설정된 패턴과 비교하여 수정이 필요한 부분을 알려주세요.
```

---

## 5️⃣ 예약 파일 테스트

### 수동 테스트 방법:

1. **예약 파일 준비**
   - 실제 사용하는 예약.xls 또는 예약.xlsx 파일
   - `D:\결산\` 폴더에 복사

2. **프로그램 실행**
   ```cmd
   python daily_report_fast.py
   ```

3. **예약 파일 업로드 버튼 클릭**

4. **로그 확인**
   ```
   📋 예약 파일 분석 중...
      파일: D:\결산\예약.xls
      행 개수: 45

   ✅ Verion: 3건
   ✅ LensX: 2건
   ✅ EX500: 1건
   ```

---

## 6️⃣ 최종 확인

모든 체크가 완료되면:

```cmd
python daily_report_fast.py
```

### 확인 사항:
- [ ] 모든 장비 경로 접근 가능
- [ ] 오늘 날짜 파일 올바르게 카운트
- [ ] 예약 파일 업로드 및 키워드 추출 정상
- [ ] 엑셀 파일 생성 성공
- [ ] PDF 변환 성공

---

## 📞 문제 발생 시

### 로그 파일 보내기:
1. `pre_run_report_YYYYMMDD.txt`
2. `directory_samples.txt`
3. 프로그램 실행 시 화면에 표시된 로그

→ Claude에게 전달하여 문제 분석 및 해결 방법 안내 받기

---

## 🎯 빠른 요약

```cmd
# 1. 사전 체크 실행
python pre_run_check.py

# 2. 생성된 파일 확인
notepad directory_samples.txt
notepad pre_run_report_YYYYMMDD.txt

# 3. 문제가 있으면 Claude에게 파일 내용 전달

# 4. 안저 경로 설정 (필요시)
python find_fundus_path.py

# 5. 최종 테스트
python daily_report_fast.py
```

---

**중요**: `directory_samples.txt` 파일의 내용을 Claude에게 보내주셔야 정확한 패턴 분석이 가능합니다!
